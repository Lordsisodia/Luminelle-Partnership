---
status: active
last_reviewed: 2025-12-29
owner: team
---

# ğŸ§  Blackbox Ops Integration Plan (repeatable)

This doc explains how to integrate and operate the â€œsingle pane of glassâ€ improvements in `docs/.blackbox` for long-running (10â€“20h) agent work.

If you want the short version: **run the monitor**, and let it continuously emit:
- telemetry (`telemetry.jsonl` + `telemetry-latest.json`)
- an append-only achievement narrative (`achievement-log.md`)
- tranche audits (`tranche-audit-status.md`)
- compaction review status (`review-status.md`)

---

## ğŸ¯ Goal (what â€œgood opsâ€ looks like)

For any long research run, we want:

1) **Evidence-backed outcomes** (tables, lists, ranked outputs).
2) **A clear timeline** of what happened (not just â€œfinal stateâ€).
3) **Self-healing memory** (steps â†’ compactions â†’ periodic reviews).
4) **Guardrails against drift** (tranche audit + min-delta).
5) **Low operator effort** (monitor loop keeps it updated).

---

## ğŸ§© What we added / rely on

### âœ… â€œProof of workâ€ artifacts (single pane of glass)

In a synthesis plan folder:

- ğŸ§¾ Achievement log (append-only):
  - `docs/.blackbox/.plans/<synth>/artifacts/achievement-log.md`
  - Maintained by: `docs/.blackbox/scripts/research/update_achievement_log.py`

- ğŸ“ˆ Telemetry:
  - `docs/.blackbox/.plans/<synth>/artifacts/telemetry.jsonl` (append-only)
  - `docs/.blackbox/.plans/<synth>/artifacts/telemetry-latest.json` (latest snapshot)
  - Written by: `docs/.blackbox/scripts/validate-loop.sh` via `collect_feature_research_metrics.py`

- ğŸ§ª Tranche audit visibility:
  - `docs/.blackbox/.plans/<synth>/artifacts/tranche-audit-status.md`
  - Written by: `docs/.blackbox/scripts/validate-loop.sh` tranche audit section

- ğŸ§  Compaction review status:
  - `docs/.blackbox/.plans/<synth>/context/reviews/review-status.md`
  - Written by: `docs/.blackbox/scripts/review-compactions.sh`

### ğŸ› ï¸ Scripts involved

- `docs/.blackbox/scripts/validate-loop.sh` â€” monitor backbone (writes telemetry + achievement log)
- `docs/.blackbox/scripts/feature-research-health.sh` â€” health check (now accepts `--plan` alias)
- `docs/.blackbox/scripts/review-compactions.sh` â€” review cadence helper
- `docs/.blackbox/scripts/research/collect_feature_research_metrics.py` â€” KPI snapshot (JSON)
- `docs/.blackbox/scripts/research/update_achievement_log.py` â€” timeline narrative (append-only)

---

## ğŸ§­ Integration workflow (how to use this every time)

### Step 0 â€” Create a feature research scaffold

From `docs/`:

```bash
./.blackbox/scripts/start-feature-research.sh \
  --target-user-first "merchant admins" \
  --license-policy "prefer permissive; flag GPL/AGPL"
```

This prints the 5 plan paths (step-01..04 + synthesis). The synthesis plan is the â€œhome baseâ€.

---

### Step 1 â€” Start the monitor (recommended default)

From `docs/`:

```bash
./.blackbox/scripts/start-10h-monitor.sh \
  --feature-research-synth .blackbox/.plans/<synth-plan> \
  --notify-local \
  --feature-research-auto-compact \
  --feature-research-compact-threshold 10
```

What this gives you:

- âœ… validates the repo + scripts stay in sync
- âœ… runs feature-research health checks
- âœ… runs tranche audits (draft detection + min-delta)
- âœ… writes telemetry + achievement log automatically (no manual step)

---

### Step 2 â€” Operate in tranches (repeatable unit of work)

We run in â€œtranchesâ€ so a 10â€“20h run never becomes a blob.

Create a tranche file:

```bash
./.blackbox/scripts/new-tranche.sh \
  --synth-plan .blackbox/.plans/<synth-plan> \
  --type live-web \
  --suffix "returns-oms" \
  --update-kpis --update-status --update-index
```

Rule of thumb:
- each tranche should produce a **minimum delta** (new competitors, new OSS candidates, new ranked learnings)
- tranche files are human-facing; step files are agent-facing

---

### Step 2b â€” Gap-driven intelligence loop (what we missed â†’ next tranche)

The system now auto-writes two MD files to keep the research loop honest:

- `artifacts/gaps-report.md` â€” â€œwhat we havenâ€™t found yetâ€ (missing snapshots, missing OSS accelerators, missing competitor proofs)
- `artifacts/next-actions.md` â€” checkbox queue derived from the gaps report

These are regenerated by the monitor loop and are designed to be directly actionable: pick the next 10 items and close the gap.

---

### Step 3 â€” Memory + compaction discipline (per agent)

Each agent:

```bash
./.blackbox/scripts/new-step.sh --plan .blackbox/.plans/<run> "Checkpoint: <what changed>"
./.blackbox/scripts/compact-context.sh --plan .blackbox/.plans/<run>
```

We prefer **many small steps** over one large essay.

---

### Step 4 â€” Review every 10 compactions (â‰ˆ100 steps)

From `docs/`:

```bash
./.blackbox/scripts/review-compactions.sh \
  --plan .blackbox/.plans/<run> \
  --write \
  --create-missing-review-scaffolds
```

Then fill the review in:
- `docs/.blackbox/.plans/<run>/context/reviews/review-0001.md`

Goal: identify patterns + delete drift content.

---

## âœ… What to check when someone asks: â€œWhat did we actually achieve?â€

Start here (synthesis plan):

1) `docs/.blackbox/.plans/<synth>/artifacts/achievement-log.md`
2) `docs/.blackbox/.plans/<synth>/artifacts/progress-dashboard.md`
3) `docs/.blackbox/.plans/<synth>/artifacts/telemetry-latest.json`

If you need the raw evidence:
- competitor/OSS tables and matrices under `artifacts/`
- OSS JSON entries under the step-04 plan `oss/entries/`

---

## ğŸ§± Optional hardening (when you want stricter runs)

### â€œHard gatesâ€ against drift

Use monitor quality gates:

```bash
./.blackbox/scripts/start-10h-monitor.sh \
  --feature-research-synth .blackbox/.plans/<synth-plan> \
  --notify-local \
  --audit-notify \
  --quality-gates \
  --max-draft-tranches 2
```

This treats tranche audit issues as failures (so drift becomes visible fast).
