# OSS Component Source Map (file pointers, no cloning)

Updated: `2025-12-31`

Goal: keep a single, tactical map from “the component we want” → “the best OSS repo(s) to mine” → “the exact file(s) to read”.

Rules:
- **Do not vendor/copy** these repos into our codebase; we use them as reference implementations.
- Prefer **concrete file pointers** over vague repo-level notes.
- If a repo is `license_bucket=verify`, treat it as reference-only until verified.

Related:
- Blocks inventory (what we want to build): `docs/.blackbox/oss-catalog/blocks-inventory.md`
- Storefront reference index: `docs/.blackbox/oss-catalog/storefront-reference-set.md`

---

## Storefront primitives (PLP/PDP/cart/search)

### Product grid + product card (PLP)
Primary sources:
- `BuilderIO/nextjs-shopify`
  - `blocks/ProductGrid/ProductGrid.tsx`
  - `components/common/ProductCard.tsx`
- `vercel/commerce`
  - `components/layout/product-grid-items.tsx` (PLP grid assembly)
  - `components/grid/tile.tsx` + `components/grid/three-items.tsx` (tiles)
  - `app/search/[collection]/page.tsx` (collection PLP route)
- `Shopify/hydrogen-v1`
  - `templates/demo-store/src/components/cards/ProductCard.client.tsx`
  - `templates/demo-store/src/components/product/ProductGrid.client.tsx`
- `Blazity/enterprise-commerce`
  - `starters/shopify-algolia/components/product-card.tsx`
  - `starters/shopify-algolia/components/mini-product-card.tsx`
- `vuestorefront/storefront-ui` (React preview showcase)
  - `apps/preview/next/pages/showcases/ProductCard/ProductCardVertical.tsx`
  - `apps/preview/next/pages/showcases/ProductCard/ProductCardHorizontal.tsx`
  - `apps/docs/components/content/_blocks/ProductCard.md` (docs block for product card patterns)

### PDP + variant selection (URL-sync option selection)
Primary sources:
- `BuilderIO/nextjs-shopify`
  - `blocks/ProductView/ProductView.tsx`
  - `components/common/OptionPicker.tsx`
- `vercel/commerce`
  - `app/product/[handle]/page.tsx` (PDP route)
  - `components/product/variant-selector.tsx` (variant selection)
  - `components/product/gallery.tsx` (gallery)
- `Shopify/hydrogen-v1`
  - `templates/demo-store/src/routes/products/[handle].server.tsx` (product page; options + selected variant)
  - `packages/hydrogen/src/hooks/useProductOptions/useProductOptions.client.ts` (variant selection state)
  - `packages/hydrogen/src/components/ProductOptionsProvider/ProductOptionsProvider.client.tsx` (provider patterns)
- `zeon-studio/storeplate` (Astro + Shopify Storefront GraphQL)
  - `src/layouts/functional-components/cart/AddToCart.tsx` (variant selection + URL sync → add-to-cart)
- `pevey/sveltekit-medusa-starter` (SvelteKit + Medusa)
  - `src/routes/product/[slug]/+page.svelte` (query param `v` variant id, URL as source of truth)
  - `src/lib/utils.ts` (`findSelectedOptions`, `findVariant`)
- `Blazity/enterprise-commerce`
  - `starters/shopify-algolia/components/product/variant.tsx`
  - `starters/shopify-algolia/components/product/variants-section.tsx`

### Cart drawer + line item editing
Primary sources:
- `BuilderIO/nextjs-shopify`
  - `components/cart/CartSidebarView/CartSidebarView.tsx`
  - `components/cart/CartItem/CartItem.tsx` (qty +/- + update-on-blur patterns)
  - `lib/shopify/storefront-data-hooks/src/hooks/*` (`useCart`, `useAddItemToCart`, `useUpdateItemQuantity`, `useRemoveItemFromCart`)
- `vercel/commerce`
  - `components/cart/cart-context.tsx` (cart state)
  - `components/cart/add-to-cart.tsx` (add-to-cart pattern)
  - `components/cart/edit-item-quantity-button.tsx` + `components/cart/delete-item-button.tsx` (line editing)
  - `components/cart/modal.tsx` + `components/cart/open-cart.tsx` (cart modal/drawer)
  - `components/cart/actions.ts` (server action glue)
- `Shopify/hydrogen-v1`
  - `templates/demo-store/src/components/global/CartDrawer.client.tsx` (drawer shell)
  - `templates/demo-store/src/components/cart/CartLineItem.client.tsx` (line item UI)
  - `packages/hydrogen/src/components/CartProvider/CartProvider.client.tsx` (cart state + actions)
  - `packages/hydrogen/src/components/CartProvider/graphql/CartLineAddMutation.ts` (cart mutations)
  - `packages/hydrogen/src/components/CartProvider/graphql/CartLineUpdateMutation.ts` (qty updates)
  - `packages/hydrogen/src/components/CartProvider/graphql/CartLineRemoveMutation.ts` (remove line)
- `zeon-studio/storeplate`
  - `src/layouts/functional-components/cart/CartModal.tsx`
  - `src/layouts/functional-components/cart/EditItemQuantityButton.tsx`
  - `src/layouts/functional-components/cart/DeleteItemButton.tsx`
  - `src/cartStore.ts` + `src/lib/utils/cartActions.ts` (nanostores + cookie cartId)
- `pevey/sveltekit-medusa-starter`
  - `src/routes/cart/+page.server.ts` (server-side form actions: add/remove/update)
  - `src/lib/components/Cart.svelte` (drawer/dialog + invalidation refresh)
- `Blazity/enterprise-commerce`
  - `starters/shopify-algolia/components/cart/cart-sheet.tsx` (cart drawer/sheet)
  - `starters/shopify-algolia/components/cart/cart-item.tsx` (line item UI)
  - `starters/shopify-algolia/components/cart/change-quantity-button.tsx` (qty editing)
  - `starters/shopify-algolia/components/cart/delete-button.tsx` (remove line)
  - `starters/shopify-algolia/stores/cart-store.ts` (cart state)
  - `starters/shopify-algolia/app/actions/cart.actions.ts` (server actions)

### Shopify Storefront API (raw GraphQL client + fragments)
Primary sources:
- `zeon-studio/storeplate`
  - `src/lib/shopify/index.ts`
  - `src/lib/shopify/fragments/cart.ts`
  - `src/lib/shopify/queries/cart.ts`
  - `src/lib/shopify/mutations/cart.ts`
- `vercel/commerce`
  - `lib/shopify/queries/*` + `lib/shopify/mutations/*` + `lib/shopify/fragments/*`
  - `lib/shopify/index.ts` + `lib/shopify/types.ts`
- `Blazity/enterprise-commerce`
  - `starters/shopify-algolia/lib/shopify/fragments/cart.ts`
  - `starters/shopify-algolia/lib/shopify/queries/cart.storefront.ts`
  - `starters/shopify-algolia/lib/shopify/mutations/cart.storefront.ts`

### Search modal / search UX
Primary sources:
- `BuilderIO/nextjs-shopify`
  - `components/common/Searchbar.tsx`
  - `lib/shopify/storefront-data-hooks/src/api/operations.ts` (`searchProducts` path)
- `vercel/commerce`
  - `app/search/page.tsx` + `app/search/[collection]/page.tsx` (search routes)
  - `components/layout/search/*` (search + collections UI primitives)
- `Blazity/enterprise-commerce`
  - `starters/shopify-algolia/components/modals/search-modal.tsx`
  - `starters/shopify-algolia/components/search-view.tsx`

### Collection filters / facets (URL-synced)
Primary sources:
- `Blazity/enterprise-commerce`
  - `starters/shopify-algolia/components/filters/facets-desktop.tsx`
  - `starters/shopify-algolia/components/filters/facets-mobile.tsx`
  - `starters/shopify-algolia/components/filters/facets-content.tsx`
  - `starters/shopify-algolia/components/filters/price-facet.tsx`
  - `starters/shopify-algolia/components/filters/vendors-facet.tsx`
  - `starters/shopify-algolia/components/filters/search-facet.tsx`
- `vercel/commerce`
  - `components/layout/search/filter/*` (filters UI primitives)
  - `app/search/layout.tsx` + `app/search/loading.tsx` (layout + loading states)
- `vuestorefront/storefront-ui` (UI primitives to compose facets)
  - `packages/sfui/frameworks/react/components/SfChip/SfChip.tsx` (selected filter “chips”)
  - `packages/sfui/frameworks/react/components/SfAccordionItem/SfAccordionItem.tsx` (collapsible facet groups)
  - `packages/sfui/frameworks/react/components/SfScrollable/SfScrollable.tsx` (horizontal chip bar)

### Shopify app primitives (OAuth, sessions, webhooks)
Primary sources:
- `kinngh/shopify-nextjs-prisma-app` (MIT)
  - `pages/api/webhooks/[...webhookTopic].js` (webhook handler)
  - `utils/middleware/verifyRequest.js` (JWT/session token → online/offline token exchange → attach session)
  - `utils/sessionHandler.js` + `utils/cryption.js` + `prisma/schema.prisma` (encrypted session persistence)
  - `pages/api/graphql.js` (Admin GraphQL proxy)
  - `pages/api/proxy_route/json.js` + `utils/middleware/verifyProxy.js` (app proxy signature verification)
  - `pages/api/gdpr/*` + `utils/middleware/verifyHmac.js` (GDPR webhooks + HMAC verification)
  - `utils/middleware/withMiddleware.js` (middleware registry)
- `carstenlebek/shopify-node-app-starter` (MIT)
  - `src/pages/api/auth/*` (online/offline OAuth flow)
  - `src/lib/shopify.ts` (Shopify Context init + webhook registry)
  - `src/pages/api/webhooks.ts` + `src/webhooks/index.ts` (webhook endpoint + handler map)
  - `src/pages/api/graphql.ts` (Admin GraphQL proxy)
  - `src/lib/sessionStorage.ts` (session storage)
  - `src/middleware.ts` + `src/middleware/verify-request.ts` (request validation + top-level redirect + CSP)

---

## Blog + content primitives (MDX, TOC, code blocks, SEO)

### Content model + MDX pipeline (Contentlayer)
Primary sources:
- `timlrx/tailwind-nextjs-starter-blog` (Contentlayer2 + Pliny)
  - `contentlayer.config.ts` (DocumentTypes + computedFields: readingTime, toc; remark/rehype plugins)
- `shadcn-ui/taxonomy` (Contentlayer + MDX for docs/blog/pages)
  - `contentlayer.config.js` (DocumentTypes + rehype-pretty-code + heading anchors)

### MDX component mapping (portable blocks)
Primary sources:
- `timlrx/tailwind-nextjs-starter-blog`
  - `components/MDXComponents.tsx` (Image/TOCInline/CustomLink/Pre/TableWrapper/NewsletterForm)
- `shadcn-ui/taxonomy`
  - `components/mdx-components.tsx` (headings/typography + Callout + Card + Image/table wrappers)
- `netlify-templates/nextjs-blog-theme` (MIT)
  - `components/CustomLink.js` (link wrapper)
  - `components/CustomImage.js` (image wrapper)
  - `utils/mdx-utils.js` (MDX loading/compilation utilities)

### TOC (extraction + UI active-heading)
Primary sources:
- `timlrx/tailwind-nextjs-starter-blog`
  - `contentlayer.config.ts` (computedFields.toc via `extractTocHeadings`)
  - `app/blog/[...slug]/page.tsx` (`MDXLayoutRenderer` receives `toc`)
- `shadcn-ui/taxonomy`
  - `lib/toc.ts` (mdast-util-toc → TableOfContents structure)
  - `components/toc.tsx` (IntersectionObserver active heading + nested Tree UI)
  - `app/(docs)/docs/[[...slug]]/page.tsx` (toc computation and rendering)

### Code blocks (highlighting + line numbers + titles)
Primary sources:
- `shadcn-ui/taxonomy`
  - `contentlayer.config.js` (rehype-pretty-code with highlight hooks)
  - `styles/mdx.css` (data-rehype-pretty-code selectors for line numbers + highlight styles)
- `timlrx/tailwind-nextjs-starter-blog`
  - `contentlayer.config.ts` (rehype-prism-plus + code title plugin)

### Blog page shells + SEO (Metadata, OpenGraph, JSON-LD)
Primary sources:
