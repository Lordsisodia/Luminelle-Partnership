../scripts/upload-to-cloudinary.ts:10:  cloud_name: process.env.CLOUDINARY_CLOUD_NAME,
../scripts/upload-to-cloudinary.ts:11:  api_key: process.env.CLOUDINARY_API_KEY,
../scripts/upload-to-cloudinary.ts:12:  api_secret: process.env.CLOUDINARY_API_SECRET,
../scripts/upload-to-cloudinary.ts:16:  if (!process.env.CLOUDINARY_CLOUD_NAME || !process.env.CLOUDINARY_API_SECRET) {
../scripts/upload-to-cloudinary.ts:17:    throw new Error('Set CLOUDINARY env vars before running')
../scripts/run-upload.cjs:2:// Uploads public/uploads/** images to Cloudinary and upserts into cms_product_media via API.
../scripts/run-upload.cjs:16:  const CLOUDINARY_CLOUD_NAME = process.env.CLOUDINARY_CLOUD_NAME || prompt('Cloudinary cloud name: ')
../scripts/run-upload.cjs:17:  const CLOUDINARY_API_KEY = process.env.CLOUDINARY_API_KEY || prompt('Cloudinary API key: ')
../scripts/run-upload.cjs:18:  const CLOUDINARY_API_SECRET = process.env.CLOUDINARY_API_SECRET || prompt('Cloudinary API secret: ', { echo: '*' })
../scripts/run-upload.cjs:19:  const UPLOAD_PRESET = process.env.VITE_CLOUDINARY_UPLOAD_PRESET || prompt('Upload preset (press Enter to skip): ')
../scripts/run-upload.cjs:23:    cloud_name: CLOUDINARY_CLOUD_NAME,
../scripts/run-upload.cjs:24:    api_key: CLOUDINARY_API_KEY,
../scripts/run-upload.cjs:25:    api_secret: CLOUDINARY_API_SECRET,
../docs/06-quality/reviews/app-ui-review-2025-12-26.md:1118:### 148) Admin “Upload” relies on Cloudinary’s external widget script with no loading/progress UI (fragile + inconsistent asset pipeline)
../docs/06-quality/reviews/app-ui-review-2025-12-26.md:1119:- **What happens:** Clicking “Upload” dynamically injects Cloudinary’s widget script (`https://widget.cloudinary.com/...`) and opens a third-party upload flow. There’s no visible loading state while the script loads, and this introduces a second media pipeline (Cloudinary URLs) alongside the existing `/uploads/...` assets and CDN tooling.
../docs/06-quality/reviews/app-ui-review-2025-12-26.md:1120:- **Where:** `src/domains/admin/catalog/ui/pages/ProductsPage.tsx` (`loadCloudinaryWidget`, `handleUpload`)
../docs/06-quality/reviews/app-ui-review-2025-12-26.md:1122:- **Suggested fix:** Add explicit loading/error UI for “Upload” (spinner + “Loading uploader…”). Standardize on one media pipeline (Supabase Storage or Cloudinary) and ensure the storefront can reliably render the resulting URLs everywhere.
../docs/06-quality/feedback/ui-issue-tracker/ui-issue-ratings-batches.md:271:| 148 | Admin | 2 | 2 | 3 | 2 | 5 | Admin “Upload” relies on Cloudinary’s external widget script with no loading/progress UI (fragile + inconsistent asset pipeline) | Upload is a high-frequency workflow. If the script is slow/blocked, the button appears broken. Mixed asset sources also create inconsistent performance and complicate CDN/SEO/image resizing strategy. |
../.env.example:100:# Cloudinary signing auth (optional but recommended)
../.env.example:114:# Cloudinary (server-side; do not expose API_SECRET to browser)
../.env.example:115:CLOUDINARY_CLOUD_NAME=
../.env.example:116:CLOUDINARY_API_KEY=
../.env.example:117:CLOUDINARY_API_SECRET=
../.env.example:118:CLOUDINARY_URL=
../.env.example:120:VITE_CLOUDINARY_CLOUD_NAME=
../.env.example:121:VITE_CLOUDINARY_UPLOAD_PRESET=
../.env.example:122:VITE_CLOUDINARY_API_KEY=
../server/migrations/2025-12-16_cms_product_media.sql:1:-- cms_product_media: stores Cloudinary media for PDP/admin
../api/admin/media/delete.ts:8:if (process.env.CLOUDINARY_CLOUD_NAME && process.env.CLOUDINARY_API_KEY && process.env.CLOUDINARY_API_SECRET) {
../api/admin/media/delete.ts:10:    cloud_name: process.env.CLOUDINARY_CLOUD_NAME,
../api/admin/media/delete.ts:11:    api_key: process.env.CLOUDINARY_API_KEY,
../api/admin/media/delete.ts:12:    api_secret: process.env.CLOUDINARY_API_SECRET,
../api/admin/media/delete.ts:32:  // Optional: Cloudinary destroy
../api/admin/media/delete.ts:33:  if (process.env.CLOUDINARY_API_SECRET) {
../api/admin/media/delete.ts:37:      console.warn('Cloudinary destroy failed', err)
../docs/06-quality/feedback/ui-issue-tracker/ui-issues/issue-148.md:1:# Issue 148: Admin “Upload” relies on Cloudinary’s external widget script with no loading/progress UI (fragile + inconsistent asset pipeline)
../api/cloudinary/sign.ts:4:// Signed upload for Cloudinary. Requires env: CLOUDINARY_CLOUD_NAME, CLOUDINARY_API_KEY, CLOUDINARY_API_SECRET
../api/cloudinary/sign.ts:8:const requiredEnv = ['CLOUDINARY_CLOUD_NAME', 'CLOUDINARY_API_KEY', 'CLOUDINARY_API_SECRET'] as const
../api/cloudinary/sign.ts:48:    .update(`${toSign}${process.env.CLOUDINARY_API_SECRET}`)
../api/cloudinary/sign.ts:54:    api_key: process.env.CLOUDINARY_API_KEY,
../api/cloudinary/sign.ts:55:    cloud_name: process.env.CLOUDINARY_CLOUD_NAME,
../docs/06-quality/feedback/ui-issue-tracker/ui-issue-tracker.md:191:| 148 | Admin | Admin “Upload” relies on Cloudinary’s external widget script with no loading/progress UI (fragile + inconsistent asset pipeline) | 2 | 2 | 3 | 2 | 5 | UNTRIAGED | [issue-148](ui-issues/issue-148.md) |
../docs/06-quality/feedback/EXECUTIVE_SUMMARY.md:74:- `#148` (P05) Upload relies on Cloudinary widget script with no loading/progress UI.
../docs/01-product/admin/admin-gap-analysis.md:132:- Gallery upload UX (uses a Cloudinary upload/sign flow).
../docs/01-product/admin/admin-gap-analysis.md:196:- Storage integration (Supabase Storage and/or Cloudinary) + metadata DB.
../src/domains/admin/catalog/ui/pages/ProductsPage.tsx:1188:  // Lazy-load Cloudinary upload widget
../src/domains/admin/catalog/ui/pages/ProductsPage.tsx:1189:  const loadCloudinaryWidget = async () => {
../src/domains/admin/catalog/ui/pages/ProductsPage.tsx:1197:      script.onerror = () => reject(new Error('Failed to load Cloudinary widget'))
../src/domains/admin/catalog/ui/pages/ProductsPage.tsx:1204:    const cld = await loadCloudinaryWidget()
../src/domains/admin/catalog/ui/pages/ProductsPage.tsx:1206:    const cloudName = import.meta.env.VITE_CLOUDINARY_CLOUD_NAME as string
../src/domains/admin/catalog/ui/pages/ProductsPage.tsx:1207:    const uploadPreset = import.meta.env.VITE_CLOUDINARY_UPLOAD_PRESET as string
../src/domains/admin/catalog/ui/pages/ProductsPage.tsx:1208:    const apiKey = import.meta.env.VITE_CLOUDINARY_API_KEY as string
../src/domains/admin/catalog/ui/pages/ProductsPage.tsx:1210:      setError('Cloudinary env missing (VITE_CLOUDINARY_CLOUD_NAME / VITE_CLOUDINARY_UPLOAD_PRESET / VITE_CLOUDINARY_API_KEY).')
../src/domains/admin/catalog/ui/pages/ProductsPage.tsx:1226:            const res = await fetch('/api/cloudinary/sign', {
